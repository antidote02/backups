<!DOCTYPE html>
<html>
<head>
<title>book.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h3 id="%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0%E9%A2%98%E4%B8%80-%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86">实践复习题一 图书信息管理</h3>
<p>本项目是一个基于 Java Web 的图书管理系统，包含管理员登录、添加图书、删除图书等功能。使用 JSP 、 Servlet 、 JDBC 进行开发，并连接 MySQL 数据库</p>
<p>开发环境：<br>
IDE ： Eclipse 或 MyEclipse<br>
JDK ： 8 及以上<br>
服务器： Apache Tomcat 8 以上<br>
数据库： MySQL 5.7 及以上<br>
依赖： JDBC 驱动 （ mysql-connector-j ）</p>
<ol start="0">
<li>PowerShell<br>
<strong>PS&gt;</strong><pre class="hljs"><code><div>mysqld --install
net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
exit;
</div></code></pre>
<strong>PS&gt;</strong><pre class="hljs"><code><div>net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
</li>
<li>数据库表结构。创建 bookdb 数据库，并在数据库中创建 admin 与 books 表， SQL 语句如下<br>
注意预先设置好一个登录账号与密码<br>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>CREATE DATABASE bookdb;
USE bookdb;
CREATE TABLE admin (
id INT AUTO_INCREMENT PRIMARY KEY,
username VARCHAR(50) NOT NULL,
password VARCHAR(50) NOT NULL
);
INSERT INTO admin (username, password) VALUES ('admin', '123456');
CREATE TABLE books (
id INT AUTO_INCREMENT PRIMARY KEY,
title VARCHAR(100) NOT NULL,
author VARCHAR(100) NOT NULL,
price DECIMAL(10,2) NOT NULL
);
</div></code></pre>
</li>
<li>创建项目，项目名为 Test + 学号，学号为两位短学号，如： Test01</li>
<li>在项目中创建一个 com.bean 的包，包下创建 Admin （管理员）、 Book （图书）两个类<br>
在项目中创建一个 com.test 的包，包下创建 LoginServlet 、 AddBookServlet 、 DeleteBookServlet 三个类<br>
<img src="图片19.png" alt=""></li>
<li>Admin 类有三个私有属性 id 、 username 、 password ， Book 有 id 、 title 、 author 、 price 属性，创建构造初始化方法与 set 、 get 方法<pre class="hljs"><code><div>package com.bean;
public class Admin {
    private int id;
    private String username;
    private String password;
    public Admin() {}
    public Admin(int id, String username, String password) {
        this.id = id;
        this.username = username;
        this.password = password;
    }
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
}
</div></code></pre>
<pre class="hljs"><code><div>package com.bean;
public class Book {
    private int id;
    private String title;
    private String author;
    private double price;
    public Book() {}
    public Book(int id, String title, String author, double price) {
        this.id = id;
        this.title = title;
        this.author = author;
        this.price = price;
    }
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public String getTitle() {
        return title;
    }
    public void setTitle(String title) {
        this.title = title;
    }
    public String getAuthor() {
        return author;
    }
    public void setAuthor(String author) {
        this.author = author;
    }
    public double getPrice() {
        return price;
    }
    public void setPrice(double price) {
        this.price = price;
    }
}
</div></code></pre>
后端接收登录信息代码<pre class="hljs"><code><div>package com.test;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import com.bean.Admin;
@WebServlet(&quot;/LoginServlet&quot;)
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter(&quot;username&quot;);
        String password = request.getParameter(&quot;password&quot;);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/bookdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement ps = conn.prepareStatement(&quot;SELECT * FROM admin WHERE username=? AND password=?&quot;);
            ps.setString(1, username);
            ps.setString(2, password);
            ResultSet rs = ps.executeQuery();
            if (rs.next()) {
                Admin admin = new Admin(rs.getInt(&quot;id&quot;), rs.getString(&quot;username&quot;), rs.getString(&quot;password&quot;));
                HttpSession session = request.getSession();
                session.setAttribute(&quot;admin&quot;, admin);
                response.sendRedirect(&quot;bookList.jsp&quot;);
            } else {
                response.getWriter().println(&quot;&lt;script&gt;alert('Invalid username or password'); window.location='index.jsp';&lt;/script&gt;&quot;);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
后端代码<br>
图书添加的业务处理<pre class="hljs"><code><div>package com.test;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.bean.Book;
@WebServlet(&quot;/AddBookServlet&quot;)
public class AddBookServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        request.setCharacterEncoding(&quot;UTF-8&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        String title = request.getParameter(&quot;title&quot;);
        String author = request.getParameter(&quot;author&quot;);
        double price = Double.parseDouble(request.getParameter(&quot;price&quot;));
        Book book = new Book(0, title, author, price);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/bookdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement ps = conn.prepareStatement(&quot;INSERT INTO books (title, author, price) VALUES (?, ?, ?)&quot;);
            ps.setString(1, book.getTitle());
            ps.setString(2, book.getAuthor());
            ps.setDouble(3, book.getPrice());
            ps.executeUpdate();
            response.sendRedirect(&quot;bookList.jsp&quot;);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
删除的后端实现代码<pre class="hljs"><code><div>package com.test;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
@WebServlet(&quot;/DeleteBookServlet&quot;)
public class DeleteBookServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/bookdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement ps = conn.prepareStatement(&quot;DELETE FROM books WHERE id=?&quot;);
            ps.setInt(1, id);
            ps.executeUpdate();
            response.sendRedirect(&quot;bookList.jsp&quot;);
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
</li>
<li>将数据库连接驱动复制粘贴到项目中<br>
<img src="图片20.png" alt=""><br>
将 mysql-connector-j.jar 加入 WEB-INF/lib ，然后右击 Build Path ，选择 Add to Build Path 即可</li>
<li>在 webapp 下（软件版本不同，有的在 WebContent ），创建登录界面，命名为 login.jsp ，如下图所示，实现管理员的登录功能<br>
<img src="图片21.png" alt=""><br>
登录页面代码<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Admin Login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;管理员登录&lt;/h2&gt;
    &lt;form action=&quot;LoginServlet&quot; method=&quot;post&quot;&gt;
        &lt;label&gt;账号:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;&lt;br&gt;
        &lt;label&gt;密码:&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
书籍管理页面（ bookList.jsp ）<pre class="hljs"><code><div>&lt;%@ page import=&quot;java.sql.*&quot; %&gt;
&lt;%@ page import=&quot;java.io.*&quot; %&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;图书界面&lt;/title&gt;
&lt;/head&gt;
    &lt;style&gt;
        form { margin-bottom: 20px; }
        table { width: 50%; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
    &lt;/style&gt;
&lt;body&gt;
    &lt;h2&gt;添加图书信息&lt;/h2&gt;
    &lt;form action=&quot;AddBookServlet&quot; method=&quot;post&quot;&gt;
        &lt;label&gt;书名:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;title&quot; required&gt;&lt;br&gt;
        &lt;label&gt;作者:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;author&quot; required&gt;&lt;br&gt;
        &lt;label&gt;价格:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;price&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;添加&quot;&gt;
    &lt;/form&gt;
    &lt;h2&gt;图书列表信息&lt;/h2&gt;
    &lt;table border=&quot;1&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;ID&lt;/th&gt;
            &lt;th&gt;书名&lt;/th&gt;
            &lt;th&gt;作者&lt;/th&gt;
            &lt;th&gt;价格&lt;/th&gt;
            &lt;th&gt;操作&lt;/th&gt;
        &lt;/tr&gt;
        &lt;%
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/bookdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement ps = conn.prepareStatement(&quot;SELECT * FROM books&quot;);
            ResultSet rs = ps.executeQuery();
            while (rs.next()) {
        %&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;%= rs.getInt(&quot;id&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getString(&quot;title&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getString(&quot;author&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getBigDecimal(&quot;price&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;a href=&quot;editBook.jsp?id=&lt;%= rs.getInt(&quot;id&quot;) %&gt;&quot;&gt;编辑&lt;/a&gt;
                &lt;a href=&quot;DeleteBookServlet?id=&lt;%= rs.getInt(&quot;id&quot;) %&gt;&quot; onclick=&quot;return confirm('确定要删除么?');&quot;&gt;删除&lt;/a&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;%
            }
            rs.close();
            ps.close();
            conn.close();
        %&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>登录成功后跳转到书籍管理页面，在界面表单中添加信息，点击按钮后，页面的列表中会显示添加的图书信息<br>
<img src="图片22.png" alt=""></li>
<li>点击表格中的删除按钮，弹出确定删除的弹框，点击确定即将该图书信息删除，删除成功后，页面重新刷新，显示新的图书列表信息<br>
<img src="图片23.png" alt=""><br>
删除成功后的界面<br>
<img src="图片24.png" alt=""></li>
<li>启动项目
<ol>
<li>在 MySQL 中执行 SQL 语句，创建数据库和表</li>
<li>在 Eclipse 中导入项目，确保 Tomcat 服务器已添加</li>
<li>将 mysql-connector-j.jar 添加到 lib 目录</li>
<li>启动 Tomcat 服务器，访问 http://localhost:8080/Test01/login.jsp 进行登录</li>
<li>登录后可进行书籍的添加、修改和删除。注意 Tomcat 的端口号是否是 8080 ，根据环境自行修改</li>
</ol>
</li>
</ol>
<h3 id="%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0%E9%A2%98%E4%BA%8C-%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86">实践复习题二 商品信息管理</h3>
<p>本项目是一个基于 Java Web 的商品管理系统，包含管理员登录、会话 Session 、添加商品、删除商品等功能。使用 JSP 、 Servlet 、 JDBC 进行开发，并连接 MySQL 数据库</p>
<p>开发环境：<br>
IDE ： Eclipse 或 MyEclipse<br>
JDK ： 8 及以上<br>
服务器： Apache Tomcat 8 以上<br>
数据库： MySQL 5.7 及以上<br>
依赖： JDBC 驱动 （ mysql-connector-j ）</p>
<ol start="0">
<li>PowerShell<br>
<strong>PS&gt;</strong><pre class="hljs"><code><div>mysqld --install
net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
exit;
</div></code></pre>
<strong>PS&gt;</strong><pre class="hljs"><code><div>net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
</li>
<li>数据库表结构。创建 productdb 数据库，并在数据库中创建 admin 与 products 表， SQL 语句如下<br>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>CREATE DATABASE productdb DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE productdb;
CREATE TABLE admin (
id INT AUTO_INCREMENT PRIMARY KEY,
username VARCHAR(50) NOT NULL,
password VARCHAR(50) NOT NULL
);
CREATE TABLE products (
id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(255) NOT NULL,
category VARCHAR(255) NOT NULL,
price DECIMAL(10,2) NOT NULL
);
INSERT INTO admin (username, password) VALUES ('admin', '123456');
</div></code></pre>
</li>
<li>创建项目，项目名为 Test + 学号，学号为两位短学号，如： Test02</li>
<li>在项目中创建一个 com.bean 的包，包下创建 Admin （管理员）、 Product （商品）两个类<br>
在项目中创建一个 com.servlet 的包，包下创建 LoginServlet 、 AddProductServlet 、 DeleteProductServlet 三个类<br>
<img src="图片1.png" alt=""></li>
<li>Admin 类有三个私有属性 <font color=blue>id</font> 、 <font color=blue>username</font> 、 <font color=blue>password</font> ， Product 有 <font color=blue>id</font> 、 <font color=blue>name</font> 、 <font color=blue>category</font> 、 <font color=blue>price</font> 属性，创建构造初始化方法与 set 、 get 方法<pre class="hljs"><code><div>package com.bean;
public class Admin {
    private int id;
    private String username;
    private String password;
    public Admin() {}
    public Admin(int id, String username, String password) {
        this.id = id;
        this.username = username;
        this.password = password;
    }
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
}
</div></code></pre>
<pre class="hljs"><code><div>package com.bean;
public class Product {
    private int id;
    private String name;
    private String category;
    private double price;
    public Product() {}
    public Product(int id, String name, String category, double price) {
        this.id = id;
        this.name = name;
        this.category = category;
        this.price = price;
    }
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getCategory() {
        return category;
    }
    public void setCategory(String category) {
        this.category = category;
    }
    public double getPrice() {
        return price;
    }
    public void setPrice(double price) {
        this.price = price;
    }
    @Override
    public String toString() {
        return &quot;Product{id=&quot; + id + &quot;, name='&quot; + name + &quot;', category='&quot; + category + &quot;', price=&quot; + price + &quot;}&quot;;
    }
}
</div></code></pre>
后端代码<br>
后端登录业务代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import com.bean.Admin;
@WebServlet(&quot;/LoginServlet&quot;)
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        request.setCharacterEncoding(&quot;UTF-8&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        String username = request.getParameter(&quot;username&quot;);
        String password = request.getParameter(&quot;password&quot;);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/productdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement ps = conn.prepareStatement(&quot;SELECT * FROM admin WHERE username=? AND password=?&quot;);
            ps.setString(1, username);
            ps.setString(2, password);
            ResultSet rs = ps.executeQuery();
            if (rs.next()) {
                Admin admin = new Admin(rs.getInt(&quot;id&quot;), rs.getString(&quot;username&quot;), rs.getString(&quot;password&quot;));
                HttpSession session = request.getSession();
                session.setAttribute(&quot;admin&quot;, username);
                response.sendRedirect(&quot;productList.jsp&quot;);
            } else {
                response.getWriter().println(&quot;&lt;script&gt;alert('无效的用户名与密码'); window.location='login.jsp';&lt;/script&gt;&quot;);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
商品添加的业务处理<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.bean.Product;
@WebServlet(&quot;/AddProductServlet&quot;)
public class AddProductServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        request.setCharacterEncoding(&quot;UTF-8&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        String name = request.getParameter(&quot;name&quot;);
        String category = request.getParameter(&quot;category&quot;);
        double price = Double.parseDouble(request.getParameter(&quot;price&quot;));
        Product product = new Product(0, name, category, price);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(
                    &quot;jdbc:mysql://localhost:3306/productdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;,
                    &quot;root&quot;, &quot;123456&quot;);
            String sql = &quot;INSERT INTO products (name, category, price) VALUES (?, ?, ?)&quot;;
            PreparedStatement ps = conn.prepareStatement(sql);
            ps.setString(1, product.getName());
            ps.setString(2, product.getCategory());
            ps.setDouble(3, product.getPrice());
            ps.executeUpdate();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        response.sendRedirect(&quot;productList.jsp&quot;);
    }
}
</div></code></pre>
删除的后端实现代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.bean.Product;
@WebServlet(&quot;/DeleteProductServlet&quot;)
public class DeleteProductServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        request.setCharacterEncoding(&quot;UTF-8&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        Product product = new Product(id, null, null, 0);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(
                    &quot;jdbc:mysql://localhost:3306/productdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;,
                    &quot;root&quot;, &quot;123456&quot;);
            String sql = &quot;DELETE FROM products WHERE id=?&quot;;
            PreparedStatement ps = conn.prepareStatement(sql);
            ps.setInt(1, product.getId());
            ps.executeUpdate();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        response.sendRedirect(&quot;productList.jsp&quot;);
    }
}
</div></code></pre>
</li>
<li>将数据库连接驱动复制粘贴到项目中<br>
<img src="图片2.png" alt=""><br>
将 mysql-connector-j.jar 加入 WEB-INF/bli ，然后右击 Build Path ，选择 Add to Build Path 即可</li>
<li>在 webapp 下（软件版本不同，有的在 WebContent ），创建登录界面，命名为 login.jsp ，如下图所示，实现管理员的登录功能<br>
在 webapp 下（软件版本不同，有的在 WebContent ），创建商品管理页面，命名为 productList.jsp ，如下图所示，实现管理员的管理功能<br>
<img src="图片3.png" alt=""><br>
登录页面代码<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Admin Login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h3 style=&quot;margin-left:50px&quot;&gt;商品管理员登录&lt;/h2&gt;
    &lt;form action=&quot;LoginServlet&quot; method=&quot;post&quot;&gt;
        &lt;label&gt;账号:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;&lt;br&gt;
        &lt;label&gt;密码:&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; style=&quot;margin-left:70px;margin-top:20px&quot; value=&quot;登录&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
商品管理页面<pre class="hljs"><code><div>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ page import=&quot;java.sql.*, java.util.*, com.bean.Product&quot; %&gt;
&lt;%
    String username = (String) session.getAttribute(&quot;admin&quot;);
    if (username == null) {
        response.sendRedirect(&quot;login.jsp&quot;);
        return;
    }
%&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;商品管理&lt;/title&gt;
&lt;/head&gt;
&lt;style&gt;
        form { margin-bottom: 20px; }
        table { width: 50%; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
    &lt;/style&gt;
&lt;body&gt;
&lt;h5&gt;欢迎, &lt;%= username %&gt;！&lt;/h2&gt;
    &lt;h2&gt;商品管理&lt;/h2&gt;
    &lt;form action=&quot;AddProductServlet&quot; method=&quot;post&quot;&gt;
        商品名: &lt;input type=&quot;text&quot; name=&quot;name&quot; required&gt;
        类别: &lt;input type=&quot;text&quot; name=&quot;category&quot; required&gt;
        价格: &lt;input type=&quot;text&quot; name=&quot;price&quot; required&gt;
        &lt;input type=&quot;submit&quot; value=&quot;添加&quot;&gt;
    &lt;/form&gt;
    &lt;h3&gt;商品列表&lt;/h3&gt;
    &lt;table border=&quot;1&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;ID&lt;/th&gt;&lt;th&gt;商品名&lt;/th&gt;&lt;th&gt;类别&lt;/th&gt;&lt;th&gt;价格&lt;/th&gt;&lt;th&gt;操作&lt;/th&gt;
        &lt;/tr&gt;
        &lt;%
            List&lt;Product&gt; productList = new ArrayList&lt;&gt;();
            try {
                Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
                Connection conn = DriverManager.getConnection(
                    &quot;jdbc:mysql://localhost:3306/productdb?useUnicode=true&amp;characterEncoding=UTF-8&quot;,
                    &quot;root&quot;, &quot;123456&quot;);
                Statement stmt = conn.createStatement();
                ResultSet rs = stmt.executeQuery(&quot;SELECT * FROM products&quot;);
                while(rs.next()) {
                    Product product = new Product(
                        rs.getInt(&quot;id&quot;),
                        rs.getString(&quot;name&quot;),
                        rs.getString(&quot;category&quot;),
                        rs.getDouble(&quot;price&quot;));
                    productList.add(product);
                }
                conn.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
            for(Product p : productList) {
        %&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;%= p.getId() %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= p.getName() %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= p.getCategory() %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= p.getPrice() %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;a href=&quot;DeleteProductServlet?id=&lt;%= p.getId() %&gt;&quot;&gt;删除&lt;/a&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;% } %&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>登录成功后跳转到商品管理页面，在界面表单中添加信息，点击按钮后，页面的列表中会显示添加的商品信息，同时通过 Session 功能显示欢迎登录用户名信息<br>
<img src="图片4.png" alt=""></li>
<li>点击表格中的删除按钮，弹出确定删除的弹框，点击确定即将该商品信息删除，删除成功后，页面重新刷新，显示新的商品列表信息<br>
<img src="图片5.png" alt=""><br>
删除成功后的界面<br>
<img src="图片6.png" alt=""></li>
<li>启动项目
<ol>
<li>在 MySQL 中执行 SQL 语句，创建数据库和表</li>
<li>在 Eclipse 中导入项目，确保 Tomcat 服务器已添加</li>
<li>将 mysql-connector-j.jar 添加到 lib 目录</li>
<li>启动 Tomcat 服务器，访问 http://localhost:8080/Test02/login.jsp 进行登录</li>
<li>登录后可进行书籍的添加、修改和删除。注意 Tomcat 的端口号是否是 8080 ，根据环境自行修改</li>
</ol>
</li>
</ol>
<h3 id="%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0%E9%A2%98%E4%B8%89-%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86">实践复习题三 订单管理</h3>
<p>本项目是一个基于 Java Web 的订单管理系统，包含订单列表信息、订单信息编辑、订单删除等功能。使用 JSP 、 Servlet 、 JDBC 进行开发，并连接 MySQL 数据库</p>
<p>开发环境：<br>
IDE ： Eclipse 或 MyEclipse<br>
JDK ： 8 及以上<br>
服务器： Apache Tomcat 8 以上<br>
数据库： MySQL 5.7 及以上<br>
依赖： JDBC 驱动 （ mysql-connector-java ）</p>
<ol start="0">
<li>PowerShell<br>
<strong>PS&gt;</strong><pre class="hljs"><code><div>mysqld --install
net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
exit;
</div></code></pre>
<strong>PS&gt;</strong><pre class="hljs"><code><div>net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
</li>
<li>数据库表结构。创建 orderdb 数据库，并在数据库中创建 orders ， SQL 语句如下<br>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>CREATE DATABASE orderdb DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE orderdb;
CREATE TABLE orders (
id INT AUTO_INCREMENT PRIMARY KEY,
product_name VARCHAR(255) NOT NULL,
price DECIMAL(10,2) NOT NULL,
order_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO orders (product_name, price) VALUES
('苹果 iPhone 15', 6999.00),
('华为 Mate 60', 6299.00),
('小米 14', 3999.00),
('MacBook Air M2', 8999.00);
</div></code></pre>
</li>
<li>创建项目，项目名为 Test + 学号，学号为两位短学号，如： Test03</li>
<li>在项目中创建一个 com.bean 的包，包下创建 Order （订单）类<br>
在项目中创建一个 com.servlet 的包，包下创建 EditOrderServlet 、 UpdateOrderServlet 、 DeleteOrderServlet 三个类<br>
<img src="图片7.png" alt=""></li>
<li>Order 类有三个私有属性 <font color=blue>id</font> 、 <font color=blue>productName</font> 、 <font color=blue>price</font> 、 <font color=blue>orderTime</font>，创建构造初始化方法与 set 、 get 方法<pre class="hljs"><code><div>package com.bean;
public class Order {
    private int id;
    private String productName;
    private double price;
    private String orderTime;
    public Order(int id, String productName, double price, String orderTime) {
        this.id = id;
        this.productName = productName;
        this.price = price;
        this.orderTime = orderTime;
    }
    public int getId() { return id; }
    public String getProductName() { return productName; }
    public double getPrice() { return price; }
    public String getOrderTime() { return orderTime; }
    public void setId(int id) {
        this.id = id;
    }
    public void setProductName(String productName) {
        this.productName = productName;
    }
    public void setPrice(double price) {
        this.price = price;
    }
    public void setOrderTime(String orderTime) {
        this.orderTime = orderTime;
    }
}
</div></code></pre>
点击编辑操作的后端处理业务代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.*;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
@WebServlet(&quot;/EditOrderServlet&quot;)
public class EditOrderServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        request.setCharacterEncoding(&quot;UTF-8&quot;);
        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(
                &quot;jdbc:mysql://localhost:3306/orderdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(
                &quot;SELECT * FROM orders WHERE id=?&quot;);
            stmt.setInt(1, id);
            ResultSet rs = stmt.executeQuery();
            if (rs.next()) {
                request.setAttribute(&quot;id&quot;, rs.getInt(&quot;id&quot;));
                request.setAttribute(&quot;productName&quot;, rs.getString(&quot;product_name&quot;));
                request.setAttribute(&quot;price&quot;, rs.getDouble(&quot;price&quot;));
            }
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        RequestDispatcher dispatcher = request.getRequestDispatcher(&quot;/editOrder.jsp&quot;);
        dispatcher.forward(request, response);
    }
}
</div></code></pre>
更新订单信息的后端业务代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
@WebServlet(&quot;/UpdateOrderServlet&quot;)
public class UpdateOrderServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        String productName = request.getParameter(&quot;productName&quot;);
        double price = Double.parseDouble(request.getParameter(&quot;price&quot;));
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/orderdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(&quot;UPDATE orders SET product_name=?, price=? WHERE id=?&quot;);
            stmt.setString(1, productName);
            stmt.setDouble(2, price);
            stmt.setInt(3, id);
            stmt.executeUpdate();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        response.sendRedirect(&quot;orderList.jsp&quot;);
    }
}
</div></code></pre>
删除的后端实现代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.sql.*;
/**
* Servlet implementation class DeleteOrderServlet
*/
@WebServlet(&quot;/DeleteOrderServlet&quot;)
public class DeleteOrderServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/orderdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(&quot;DELETE FROM orders WHERE id=?&quot;);
            stmt.setInt(1, id);
            stmt.executeUpdate();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        response.sendRedirect(&quot;orderList.jsp&quot;);
    }
}
</div></code></pre>
</li>
<li>将数据库连接驱动复制粘贴到项目中<br>
<img src="图片8.png" alt=""><br>
将 mysql-connector-j.jar 加入 WEB-INF/lib ，然后右击 Build Path ，选择 Add to Build Path 即可</li>
<li>在 webapp 下（软件版本不同，有的在 WebContent ），创建订单列表界面，命名为 orderList.jsp ，如下图所示<br>
<img src="图片9.png" alt=""><br>
订单列表页面代码<pre class="hljs"><code><div>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ page import=&quot;java.sql.*&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;订单管理&lt;/title&gt;
&lt;/head&gt;
&lt;style&gt;
        form { margin-bottom: 20px; }
        table { width: 50%; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
&lt;/style&gt;
&lt;body&gt;
    &lt;h3&gt;订单列表&lt;/h3&gt;
    &lt;table border=&quot;1&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;ID&lt;/th&gt;&lt;th&gt;商品名称&lt;/th&gt;&lt;th&gt;价格&lt;/th&gt;&lt;th&gt;时间&lt;/th&gt;&lt;th&gt;操作&lt;/th&gt;
        &lt;/tr&gt;
        &lt;% 
            try {
                Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
                Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/orderdb?useSSL=false&amp;serverTimezone=UTC&quot;, &quot;root&quot;, &quot;123456&quot;);
                Statement stmt = conn.createStatement();
                ResultSet rs = stmt.executeQuery(&quot;SELECT * FROM orders&quot;);
                while(rs.next()) {
        %&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;%= rs.getInt(&quot;id&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getString(&quot;product_name&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getDouble(&quot;price&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;&lt;%= rs.getTimestamp(&quot;order_time&quot;) %&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;a href=&quot;EditOrderServlet?id=&lt;%= rs.getInt(&quot;id&quot;) %&gt;&quot;&gt;编辑&lt;/a&gt; |
                &lt;a href=&quot;DeleteOrderServlet?id=&lt;%= rs.getInt(&quot;id&quot;) %&gt;&quot; onclick=&quot;return confirm('确定删除吗？')&quot;&gt;删除&lt;/a&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;% 
                }
                conn.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        %&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>点击编辑按钮进入编辑页面，页面如下，创建名称为 editOrder.jsp 。然后修改订单信息，点击更新按钮，成功后回到订单列表信息页面<br>
<img src="图片10.png" alt=""><br>
编辑页面代码<pre class="hljs"><code><div>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;编辑订单&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;编辑订单&lt;/h2&gt;
    &lt;form action=&quot;UpdateOrderServlet&quot; method=&quot;post&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;&lt;%= request.getAttribute(&quot;id&quot;) %&gt;&quot;&gt;
        商品: &lt;input type=&quot;text&quot; name=&quot;productName&quot; value=&quot;&lt;%= request.getAttribute(&quot;productName&quot;) %&gt;&quot; required&gt;&lt;br&gt;
        价格: &lt;input type=&quot;text&quot; name=&quot;price&quot; value=&quot;&lt;%= request.getAttribute(&quot;price&quot;) %&gt;&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;更新&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>点击表格中的删除按钮，弹出确定删除的弹框，点击确定即将该订单信息删除，删除成功后，页面重新刷新，显示新的订单列表信息<br>
<img src="图片11.png" alt=""><br>
删除成功后的界面<br>
<img src="图片12.png" alt=""></li>
<li>启动项目
<ol>
<li>在 MySQL 中执行 SQL 语句，创建数据库和表</li>
<li>在 Eclipse 中导入项目，确保 Tomcat 服务器已添加</li>
<li>将 mysql-connector-j.jar 添加到 lib 目录</li>
<li>启动 Tomcat 服务器，访问 http://localhost:8080/Test03/orderList.jsp 进行登录</li>
<li>登录后可进行订单的编辑和删除。注意 Tomcat 的端口号是否是 8080 ，根据环境自行修改</li>
</ol>
</li>
</ol>
<h3 id="%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0%E9%A2%98%E5%9B%9B-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%BC%96%E8%BE%91">实践复习题四 用户信息编辑</h3>
<p>本项目是一个基于 Java Web 的用户信息编辑系统，包含用户登录、用户注册、密码修改功能。使用 JSP 、 Servlet 、 JDBC 进行开发，并连接 MySQL 数据库</p>
<p>开发环境：
IDE ： Eclipse 或者 MyEclipse
JDK ： 8 及以上
服务器： Apache Tomcat 8 以上
数据库： MySQL 5.7 及以上
依赖： JDBC 驱动（ mysql-connector-j ）</p>
<ol start="0">
<li>PowerShell<br>
<strong>PS&gt;</strong><pre class="hljs"><code><div>mysqld --install
net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
<strong>mysql&gt;</strong><pre class="hljs"><code><div>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
exit;
</div></code></pre>
<strong>PS&gt;</strong><pre class="hljs"><code><div>net stop mysql
net start mysql
mysql -u root -p
</div></code></pre>
</li>
<li>数据库表结构。创建 userdb 数据库，并在数据库中创建 users 表， SQL 语句如下
<strong>mysql&gt;</strong><pre class="hljs"><code><div>CREATE DATABASE userdb;
USE userdb;
CREATE TABLE users (
id INT PRIMARY KEY AUTO_INCREMENT,
username VARCHAR(50) NOT NULL UNIQUE,
password VARCHAR(255) NOT NULL,
phone VARCHAR(20) NOT NULL
);
</div></code></pre>
</li>
<li>创建项目，项目名为 Test + 学号，学号为两位短学号，如： Test04</li>
<li>在项目中创建一个 com.bean 的包，包下创建 User （用户）类<br>
在项目中创建一个 com.servlet 的包，包下创建 LoginServlet 、 RegisterServlet 、 ChangePasswordServlet 三个类<br>
<img src="图片13.png" alt=""></li>
<li>User 类有四个私有属性 <font color=blue>id</font> 、 <font color=blue>username</font> 、 <font color=blue>password</font> 、 <font color=blue>phone</font> ，创建构造初始化方法与 set 、 get 方法<pre class="hljs"><code><div>package com.bean;
public class User {
    private int id;
    private String username;
    private String password;
    private String phone;
    public User() {}
    public User(int id, String username, String password, String phone) {
        this.id = id;
        this.username = username;
        this.password = password;
        this.phone = phone;
    }
    public int getId() { return id; }
    public String getUsername() { return username; }
    public String getPassword() { return password; }
    public String getPhone() { return phone; }
    public void setId(int id) { this.id = id; }
    public void setUsername(String username) { this.username = username; }
    public void setPassword(String password) { this.password = password; }
    public void setPhone(String phone) { this.phone = phone; }
}
</div></code></pre>
后端接受登录信息代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
@WebServlet(&quot;/LoginServlet&quot;)
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        String username = request.getParameter(&quot;username&quot;);
        String password = request.getParameter(&quot;password&quot;);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/userdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(&quot;SELECT * FROM users WHERE username=? AND password=?&quot;);
            stmt.setString(1, username);
            stmt.setString(2, password);
            ResultSet rs = stmt.executeQuery();
            if (rs.next()) {
                HttpSession session = request.getSession();
                session.setAttribute(&quot;username&quot;, username);
                response.sendRedirect(&quot;welcome.jsp&quot;);
            } else {
                response.getWriter().println(&quot;用户名或密码错误！&quot;);
            }
            rs.close();
            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
后端注册处理业务代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
import com.bean.User;
@WebServlet(&quot;/RegisterServlet&quot;)
public class RegisterServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        String username = request.getParameter(&quot;username&quot;);
        String password = request.getParameter(&quot;password&quot;);
        String confirmPassword = request.getParameter(&quot;confirmPassword&quot;);
        String phone = request.getParameter(&quot;phone&quot;);
        if (!password.equals(confirmPassword)) {
            response.getWriter().println(&quot;两次输入的密码不一致！&quot;);
            return;
        }
        User u=new User();
        u.setUsername(username);
        u.setPassword(password);
        u.setPhone(phone);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/userdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(&quot;INSERT INTO users (username, password, phone) VALUES (?, ?, ?)&quot;);
            stmt.setString(1, u.getUsername());
            stmt.setString(2, u.getPassword());
            stmt.setString(3, u.getPhone());
            if (stmt.executeUpdate() &gt; 0) {
                response.sendRedirect(&quot;login.jsp&quot;);
            } else {
                response.getWriter().println(&quot;注册失败！&quot;);
            }
            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
后端实现代码<pre class="hljs"><code><div>package com.servlet;
import java.io.IOException;
import java.sql.*;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
@WebServlet(&quot;/ChangePasswordServlet&quot;)
public class ChangePasswordServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        String username = request.getParameter(&quot;username&quot;);
        String newPassword = request.getParameter(&quot;newPassword&quot;);
        try {
            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);
            Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/userdb&quot;, &quot;root&quot;, &quot;123456&quot;);
            PreparedStatement stmt = conn.prepareStatement(&quot;UPDATE users SET password=? WHERE username=?&quot;);
            stmt.setString(1, newPassword);
            stmt.setString(2, username);
            if (stmt.executeUpdate() &gt; 0) {
                response.sendRedirect(&quot;login.jsp&quot;);
            } else {
                response.getWriter().println(&quot;密码修改失败！&quot;);
            }
            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</div></code></pre>
</li>
<li>将数据库连接驱动复制粘贴到项目中<br>
<img src="图片14.png" alt=""><br>
将 mysql-connector-j 加入 WEB-INF/lib ，然后右击 Build Path ，选择 Add to Build Path 即可</li>
<li>在 webapp 下（软件版本不同，有的在 WebContent ），创建登录界面，命名为 login.jsp ，如下图所示，实现用户登录功能，在首次登录时需要点击注册进行用户信息注册，注册界面为 register.jsp<br>
<img src="图片15.png" alt=""><br>
<img src="图片16.png" alt=""><br>
登录页面代码<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html; charset=UTF-8&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;用户登录&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;用户登录&lt;/h2&gt;
    &lt;form action=&quot;LoginServlet&quot; method=&quot;post&quot;&gt;
        用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;&lt;br&gt;
    &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;密码:&lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;
    &lt;/form&gt;
    &lt;a href=&quot;register.jsp&quot;&gt;注册&lt;/a&gt; | &lt;a href=&quot;passwordChange.jsp&quot;&gt;修改密码&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
注册页面代码<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html; charset=UTF-8&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;用户注册&lt;/title&gt;
&lt;/head&gt;
&lt;style&gt;
    input{
    margin-top:5px
    }
&lt;/style&gt;
&lt;body&gt;
    &lt;h2&gt;用户注册&lt;/h2&gt;
    &lt;form action=&quot;RegisterServlet&quot; method=&quot;post&quot;&gt;
        用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;&lt;br&gt;
        密码: &lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;&lt;br&gt;
        确认密码: &lt;input type=&quot;password&quot; name=&quot;confirmPassword&quot; required&gt;&lt;br&gt;
        电话:&lt;input type=&quot;text&quot; name=&quot;phone&quot; required&gt;&lt;br&gt;
    &lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;
    &lt;/form&gt;
    &lt;a href=&quot;login.jsp&quot;&gt;返回登录&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>登录成功后跳转到欢迎页面，页面为 welcome.jsp ，通过会话 Session 获取用户的用户名信息，界面如下图所示。点击退出又重新回到登录页面<br>
<img src="图片17.png" alt=""><br>
欢迎页面<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html; charset=UTF-8&quot; %&gt;
&lt;%@ page import=&quot;javax.servlet.http.HttpSession&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;欢迎&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;欢迎, &lt;%= session.getAttribute(&quot;username&quot;) %&gt;!&lt;/h2&gt;
    &lt;a href=&quot;login.jsp&quot;&gt;退出&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>如果用户要修改密码，点击登录界面中的忘记密码进入密码修改界面， passwordChange.jsp<br>
<img src="图片18.png" alt=""><br>
密码修改界面代码<pre class="hljs"><code><div>&lt;%@ page contentType=&quot;text/html; charset=UTF-8&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;修改密码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;修改密码&lt;/h2&gt;
    &lt;form action=&quot;ChangePasswordServlet&quot; method=&quot;post&quot;&gt;
        用户名: &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;&lt;br&gt;
        新密码: &lt;input type=&quot;password&quot; name=&quot;newPassword&quot; required&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;修改&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
</li>
<li>启动项目
<ol>
<li>在 MySQL 中执行 SQL 语句，创建数据库和表</li>
<li>在 Eclipse 中导入项目，确保 Tomcat 服务器已添加</li>
<li>将 mysql-connector-j.jar 添加到 lib 目录</li>
<li>启动 Tomcat 服务器，访问 http://localhost:8080/Test04/login.jsp 进行登录</li>
<li>登录后可进行书籍的添加、修改和删除。注意 Tomcat 的端口号是否是 8080 ，根据环境自行修改</li>
</ol>
</li>
</ol>

</body>
</html>
